## TCP/IP 四层模型和 OSI 七层模型

| TCP/IP     | OSI                  |
| ---------- | -------------------- |
| 应用层     | 应用层 表示层 会话层 |
| 传输层     | 传输层               |
| 网络层     | 网络层               |
| 网络接口层 | 数据链路层物理层     |

## TCP 和 UDP

```
TCP是面向连接、可靠、基于字节流的传输层协议，是专门为了在不可靠的网络中提供一个可靠的端对端字节流而设计的
UDP是OSI模型中一种无连接的传输层协议，提供简单不可靠的非链接传输层服务，面向报文
区别：
    1.TCP面向连接，可靠性高；UDP基于非链接，可靠性低
    2.TCP是连接的通信，需要三次握手等连接过程，会有延时；UDP没有建立连接的过程，实时性高
    3.传输相同大小数据时，TCP开销大，UDP开销小
    4.TCP只能一对一，UDP可以一对多、多对一、多对多
使用场景：
    1.追求实时性，高速传输的场景使用UDP
    2.需要传输大量数据并对可靠性要求高的场景使用TCP
```

## FTP 和 DNS

```
FTP（文件传输协议）基于TCP协议的应用层协议
DNS就基于UDP协议的应用层协议
```

## HTTP 和 HTTPS

```
HTTP: 超文本传输协议，是基于TCP/IP协议来传递数据
HTTPS： 超文本传输安全协议，基于HTTP进行通信，同时利用SSL/TLS加密数据，保护交换数据的隐私和完整性
```

### HTTPS 是如何传输的（传输流程）

```
1.TCP三次握手
2.客户端验证服务器数字证书
3.DH算法协商对称加密算法的密钥和hash算法的密钥
4.SSL安全加密隧道协商完成
5.网页以加密的方式创数，用协商的对称加密算法和密钥进行加密，保证数据机密性；用协商的hash算法进行数据完整性保护。
```

### HTTP 和 HTTPS 的区别

| 区别     | HTTP                                            | HTTPS                                             |
| -------- | ----------------------------------------------- | ------------------------------------------------- |
| 端口     | 80                                              | 443                                               |
| 传输     | 明文传输                                        | 数据传输过程加密                                  |
| 安全性   | 较差                                            | 较好                                              |
| 证书     | 无                                              | 需要向 CA 申请数字证书                            |
| 响应速度 | 较快 只有三次握手 客户端和服务器之间交换 3 个包 | 较慢 除了三次握手，还有 SSL/TLS 握手 交换 12 个包 |
| 耗费资源 | 较低                                            | 较高                                              |

### HTTP 报文

```
HTTP报文分为请求报文和响应报文
请求报文： 请求行 请求头 请求内容
响应报文： 响应行 响应头 响应内容
```

### HTTP 状态码

| 状态码 | 含义                                                                      |
| ------ | ------------------------------------------------------------------------- |
| 100    | 继续， 一般在发送 post 请求时，已发送了请求头后服务器返回此信息，表示确认 |
| 200    | 成功， 表示客户端发送的请求被服务器正常处理                               |
| 204    | no content， 表示客户端发送的请求被服务器正常处理，但响应报文不含内容实体 |
| 206    | partial content， 表示进行范围请求成功                                    |
| 301    | 永久重定向，表示资源已被分配了新的 URL                                    |
| 302    | 临时重定向，表示资源已被临时分配了新的 URL                                |
| 303    | 表示资源存在另一个 URL，应该使用 GET 方法获取资源                         |
| 304    | 资源未被修改，使用缓存                                                    |
| 307    | 临时重定向，和 302 类似，但是期望客户端保持请求方式不变向新地址发送请求   |
| 400    | 请求报文存在语法错误                                                      |
| 401    | 表示未授权，发送的请求需要通过认证                                        |
| 403    | 表示请求被服务器拒绝，可在实体部分返回原因描述，常见的有跨域              |
| 404    | 表示服务器未找到请求的资源                                                |
| 500    | 表示服务器在执行请求时发生了错误                                          |
| 501    | 表示服务器不支持当前请求                                                  |
| 503    | 表示服务器停机或超负载                                                    |
| 504    | 网关超时                                                                  |

:::tip
对于 301-303，浏览器会自动重新发送一个 get 请求
:::

### HTTP 版本

| 版本    | 描述                                                                                                                                                       |
| ------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| http0.9 | 只有一个 get 命令，服务器只能响应 html 格式的字符串，每次请求都要三次握手四次挥手                                                                          |
| http1.0 | 新增了 post、head 请求，支持服务器响应图像、视频、二进制等文件                                                                                             |
| http1.1 | 引入持久连接、管道机制、content-length、分块传输编码、put、patch、options、delete、trace、connect 请求，缺点：响应数据时按顺序返回的，所以会出现"对头阻塞" |
| http2   | 二进制协议、多工通信、数据流、头信息压缩、服务器推送，缺点：多个 http 请求一旦发生丢包，就会触发 TCP 重传机制                                              |
| http3   | 为了解决http2的缺点，把http下层的TCP协议改成了UDP协议  |

::: tip
管道机制：一个 TCP 连接可以发送多个请求，服务器按管道顺序返回<br>
数据流: 每个数据包都有唯一标识，所以不需要按顺序响应<br>
:::

### HTTP 常见请求

```
get（获取资源） post（提交数据） put（修改数据） delete（删除数据） head（获取资源的元信息）
options（列出可对资源实行的请求方法，预见请求，用来跨域请求） connect（建立连接隧道，用于代理服务器）
trace（追踪资源-响应的传输数据） patch （更新局部资源）
```

### 为什么有时候请求会发送两次？
```
当发送比如post put delete等复杂请求跨域的时候，浏览器会发送两次请求
两次请求分别是：options预检请求，真正的请求
原因：
    因为浏览器限制跨域一般有两种方式，一种是直接限制跨域请求地发出，另一种是请求到达了服务器，但是响应被浏览器拦截了。
    一般浏览器都是第二种方式，这种方式可能会导致跨域请求虽然返回时被拦截，但是还是到达了服务器并对数据库的数据产生影响。
    所以为了防止这种情况，浏览器会先发送一个options预检请求来得知服务器是否允许跨域请求，若允许，则第二次发送真实请求。
```
:::tip
在使用CORS跨域资源共享时，就是使用的options预检请求。<br>
预检请求不是每一次都会产生，因为浏览器会对预检请求缓存，通过服务器设置Access-control-max-age设置缓存时间。
:::

## DNS
```
DNS是域名解析系统，基于UDP协议， 端口53
用于将域名解析为IP地址

DNS解析全过程：
1.向浏览器>系统>路由器>ISP DNS缓存，若有缓存，则返回
2.若没有，就进行迭代查询
```
:::tip
迭代查询：<br>
1.本地域名服务器将该请求转发到互联网的根域名服务器<br>
2.根域名服务器将域名的顶级域的服务器IP返回本地DNS<br>
3.本地DNS根据返回的IP向顶级域发送请求<br>
4.顶级域将域名的二级域的服务器IP返回本地DNS<br>
5.本地DNS根据返回的IP向二级域发送请求<br>
6.循环这些过程，直到本地DNS服务器得到最终的查询结果<br>
:::


## 从输入URL到页面展示经历了什么
```
1.输入URL
2.通过DNS获取IP
3.浏览器通过IP与服务器建立TCP连接
4.服务器将资源返回至浏览器
5.浏览器接收资源并下载
6.浏览器解析资源后，渲染页面并执行脚本
```

## CDN
```
CDN: 分布式网络架构，旨在加速互联网内容的传递，提供更快的访问速度和更高的性能。
```
:::tip
为什么CDN速度快？<br>
因为CDN在全球各地放置边缘服务器，CDN能够实时根据网络流量和各边缘服务器的连接负载等将用户的请求重定向到最合适的边缘服务器上，加速访问。
:::
